#!/bin/bash

# Converts a given raw payload ($1) and extracts the raw hex bytes. If given as $2, it will ouput to a file.


payload_file="$1"
output_file="$2"

if [[ -z "$payload_file" ]]
then
	echo "Converts a given raw payload, and pulls out the bytes in hex:"
	echo 'Usage: $0 $path_to_payload <$output_file_to_write>'
	exit 0
fi


if [[ -z "$output_file" ]]
then
	hexdump -C $payload_file |grep 0 | egrep -v "^$(hexdump -C $payload_file |grep 0 | tail -n 1)$" |cut -d" " -f3-19 | sed 's/ //g'  |tr -d '\n'
	exit 0
else
	hexdump -C $payload_file |grep 0 | egrep -v "^$(hexdump -C $payload_file |grep 0 | tail -n 1)$" |cut -d" " -f3-19 | sed 's/ //g'  |tr -d '\n' > $output_file
	exit 0
fi

